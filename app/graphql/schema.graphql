scalar JSON


enum UserRole {
  ADMIN
  TEAM_LEAD
  DEVELOPER
  DEVOPS
  QA
}

type AuthPayload {
    accessToken: String!
    refreshToken: String!
}

type AccessTokenPayload {
    accessToken: String!
}


type User {
  id: ID!
  email: String!
  name: String!
  role: UserRole!
  isActive: Boolean!
}

type UserPage {
  items: [User!]!
  page: Int!
  pageSize: Int!
  totalItems: Int!
  totalPages: Int!
}


input CreateUserInput {
  email: String!
  name: String!
  role: UserRole!
  password: String!
} 

input UpdateUserInput {
  name: String
  role: UserRole
  isActive: Boolean
}


type Integration {
  id: ID!
  name: String!
  description: String
  createdBy: ID!
  createdAt: String!
  isDeleted: Boolean!
}


type IntegrationPagination {
  items: [Integration!]!
  page: Int!
  pageSize: Int!
  totalItems: Int!
  totalPages: Int!
}


input CreateIntegrationInput {
  name: String!
  description: String
  assignedUserId: ID
}

input UpdateIntegrationInput {
  name: String
  description: String
}


type EnvironmentType {
  id: ID!
  name: String!
  createdAt: String!
  createdBy: String!
}


input CreateEnvironmentTypeInput {
  name: String!
}


type Environment {
  id: ID!
  integrationId: ID!
  environmentType: String!
  title: String!
  content: JSON!
  createdBy: ID!
  updatedBy: ID!
  createdAt: String!
  updatedAt: String!
}


input CreateEnvironmentInput {
  environmentType: String!
  title: String!
  content: JSON!
}


input UpdateEnvironmentInput {
  title: String
  content: JSON 
}






##### QUERY ########

type Query {

    #Users
    me: User
    users(page: Int = 1 pageSize: Int = 10 search: String): UserPage!


    #Integration
    integrations(assignedUserId: ID page: Int = 1 pageSize: Int = 10 search: String): IntegrationPagination!
    integration(integrationId: ID!): Integration
    userIntegrations(userId: ID!): [Integration!]!

    #environment
    environments(integrationId: ID!): [Environment!]!
    environment(environmentId: ID!): Environment

    #environment_types
    environmentTypes: [EnvironmentType!]



    }


##### MUTATION #######

type Mutation {

    #Users    
    login(email: String!, password: String!): AuthPayload!
    refreshToken(refreshToken: String!): AccessTokenPayload!
    createUser(input:CreateUserInput!): User!
    updateUser(userId: ID!, input: UpdateUserInput!): User!


    #integrations
    createIntegration(input: CreateIntegrationInput!): Integration!
    updateIntegration(integrationId: ID!, input: UpdateIntegrationInput!): Integration!
    deleteIntegration(integrationId: ID!): Boolean!
    assignUserToIntegration(integrationId: ID! userId: ID!): Boolean!
    removeUserFromIntegration(integrationId: ID! userId: ID!): Boolean!


    # Environment Type
    createEnvironmentType(input: CreateEnvironmentTypeInput!): EnvironmentType!


    # Environment
    createEnvironment(integrationId: ID! input: CreateEnvironmentInput!): Environment!
    updateEnvironment(integrationId: ID! environmentId: ID! input: UpdateEnvironmentInput! ): Environment!
    deleteEnvironment(integrationId: ID! environmentId: ID! ): Boolean!

    }
